sequenceDiagram
    participant Client
    participant LlamaStack
    participant MCPTool
    participant Keycloak

    Client->>LlamaStack: Request + Token A
    LlamaStack->>Keycloak: Validate Token A
    Keycloak-->>LlamaStack: Token valid

    Note over LlamaStack,MCPTool: Delegated Token Exchange
    LlamaStack->>Keycloak: Exchange Token A â†’ Token B (scoped)
    Keycloak-->>LlamaStack: Token B
    LlamaStack->>MCPTool: Call with Token B (scoped, short-lived)
    MCPTool-->>LlamaStack: Executes with least privilege
    LlamaStack-->>Client: Response
